#中间件：
## Eureka
### 一、考虑
  1. 设计需要考虑的因素
  2. 为什么如此设计
  3. 可以优化的地方
### 二、设计问题
  1. 注册中心，需要考虑的问题  
  . 第一: 存储问题需要考虑 , 注册中心的作用是用来存储各个服务器的地址端口等信息；
  . 第二: 存储的方式，是各系统推送数据还是存储器主动拉取数据？频率如何考虑？通过什么通信方式，是socket通信？
  . 第三： 注册服务的准确性、实时性、可靠性如何考虑？
  . 第四： 服务过多，压力如何解决？
  2. 注册步骤
   ![image](https://yqfile.alicdn.com/a8a41ec4f46c5c108b2e525f1905bad3ffe724fe.png)   
### 三. 自我保护机制
   - Eureka 各个节点是平等的，没有ZK中角色的概念。即使N-1个节点挂掉也不会影响其他节点的正常运行。
    自我保护机制是一种针对网络异常波动的安全保护措施，使用自我保护模式能使Eureka集群更加的健壮、稳定的运行。
  1. 目的   
         默认情况下，如果Eureka Server 在一定时间内（默认的是90秒）没有接收到某个服务实例的心跳，Eureka Server将移出该实例。
     在网络分区故障发生时，微服务与Eureka Server之间无法正常通信，但是微服务本身是正常运行的，这种情况下，是不应该移出该微服务实例的，
     所以引入了自我保护机制。
  2. 工作原理
         如果在15分钟之内超过85%的客户端节点都没有正常的心跳，那么Eureka就认为客户端与注册中心出现了网络故障，Eureka Server自动进入
     自我保护机制。 
  3. 在保护机制下，Eureka server的工作状态
  - 不在从注册列表中移出因为长时间没有收到心跳而应该过期的服务实例；
  - 仍然可以接受新服务的注册和查询请求，但是不会被同步到其他节点上，保证当前节点依然可用；
  - 当网络稳定时，当前Eureka Server新的注册信息会被同步到其他节点中；
### 四   
  
  
  
  
  
  
## 待整理问题
因此Eureka Server可以很好的应对因网络故障导致部分节点失联的情况，而不会像ZK那样如果有一半不可用的情况会导致整个集群不可用而变成瘫痪。  